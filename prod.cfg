[buildout]
extends =
    base.cfg

allow-picked-versions = false

parts +=
    instance-debug
    zeoserver

[instance]
recipe = plone.recipe.zope2instance
http-address = ${port:instance-http}
zeo-client = true
zeo-address = ${port:zeo-docker}:${port:zeo}
zodb-cache-size = 40000
zeo-client-cache-size = 300MB
shared-blob = off
zope-conf-additional +=
  <product-config five.z2monitor>
     bind 127.0.0.1:${port:instance-monitor}
  </product-config>
  %define ZEOADDRESS ${zeoserver:zeo-address}
  %define ZEOINSTANCE ${buildout:directory}/parts/zeoserver/var
eggs +=
    archetypes.schematuning
    collective.monitor
zcml +=
    collective.monitor
event-log-custom =
    <logfile>
        path ${buildout:directory}/var/log/${:_buildout_section_name_}.log
        level INFO
    </logfile>

[instance-debug]
<= instance
http-address = ${port:instance-debug-http}
debug-mode = on
verbose-security = on
eggs =
    ${instance:eggs}
    ${debug:eggs}
zcml =
    ${instance:zcml}
    ${debug:zcml}
